{"is_source_file": true, "format": "Python", "description": "This file provides storage utilities for recipes, including in-memory and JSON file-backed storage, along with session management. It includes functions for reading, writing, listing, creating, updating, and deleting recipes, as well as session creation and validation.", "external_files": ["os", "json", "threading", "time", "typing"], "external_methods": ["os.environ.get", "os.makedirs", "os.path.exists", "os.path.dirname", "open", "os.replace"], "published": ["list_recipes", "get_recipe", "create_recipe", "update_recipe", "delete_recipe", "create_session", "get_session", "delete_session"], "classes": [], "methods": [{"name": "Dict _read_file()", "description": "Reads and parses the JSON storage file, returning a default structure if file not found or invalid.", "scope": "", "scopeKind": ""}, {"name": "None _write_file(data: Dict)", "description": "Writes data to the JSON storage file safely using a temporary file.", "scope": "", "scopeKind": ""}, {"name": "Dict _normalize_recipe(recipe: Dict)", "description": "Ensures the recipe dictionary has all required fields with default values.", "scope": "", "scopeKind": ""}, {"name": "Tuple[List[Dict],Dict] list_recipes(q: Optional[str] = None, ingredient: Optional[str] = None, page: int = 1, page_size: int = 10)", "description": "Lists recipes with optional search filters and pagination.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict] get_recipe(recipe_id: int)", "description": "Retrieves a single recipe by ID.", "scope": "", "scopeKind": ""}, {"name": "Dict create_recipe(recipe: Dict)", "description": "Creates a new recipe, assigning it a unique ID and timestamps.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict] update_recipe(recipe_id: int, updates: Dict)", "description": "Updates an existing recipe by ID with the provided fields.", "scope": "", "scopeKind": ""}, {"name": "bool delete_recipe(recipe_id: int)", "description": "Deletes a recipe by ID.", "scope": "", "scopeKind": ""}, {"name": "str create_session(user_id: str, user_name: str)", "description": "Creates a new user session token.", "scope": "", "scopeKind": ""}, {"name": "Optional[Dict] get_session(token: str)", "description": "Retrieves session data for a given token.", "scope": "", "scopeKind": ""}, {"name": "None delete_session(token: str)", "description": "Invalidates a session token.", "scope": "", "scopeKind": ""}], "calls": ["_read_file", "_write_file", "_normalize_recipe", "json.load", "json.dump", "os.replace", "os.path.exists", "open", "os.makedirs"], "search-terms": ["recipe storage", "JSON file persistence", "recipe CRUD", "session management", "threading lock"], "state": 2, "file_id": 7, "knowledge_revision": 15, "git_revision": "", "ctags": [{"_type": "tag", "name": "_STORAGE_FILE", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^_STORAGE_FILE = os.environ.get(\"RECIPES_STORE_PATH\", \"data\\/recipes.json\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_lock", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^_lock = threading.RLock()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_normalize_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def _normalize_recipe(recipe: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(recipe: Dict)"}, {"_type": "tag", "name": "_read_file", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def _read_file() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "_session_lock", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^_session_lock = threading.RLock()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_sessions", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^_sessions: Dict[str, Dict] = {}$/", "language": "Python", "typeref": "typename:Dict[str, Dict]", "kind": "variable"}, {"_type": "tag", "name": "_write_file", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def _write_file(data: Dict) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(data: Dict)"}, {"_type": "tag", "name": "create_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def create_recipe(recipe: Dict) -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "(recipe: Dict)"}, {"_type": "tag", "name": "create_session", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def create_session(user_id: str, user_name: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(user_id: str, user_name: str)"}, {"_type": "tag", "name": "delete_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def delete_recipe(recipe_id: int) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(recipe_id: int)"}, {"_type": "tag", "name": "delete_session", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def delete_session(token: str) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "get_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def get_recipe(recipe_id: int) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "function", "signature": "(recipe_id: int)"}, {"_type": "tag", "name": "get_session", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def get_session(token: str) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "function", "signature": "(token: str)"}, {"_type": "tag", "name": "list_recipes", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def list_recipes(q: Optional[str] = None, ingredient: Optional[str] = None, page: int = 1, page_/", "language": "Python", "typeref": "typename:Tuple[List[Dict],Dict]", "kind": "function", "signature": "(q: Optional[str] = None, ingredient: Optional[str] = None, page: int = 1, page_size: int = 10)"}, {"_type": "tag", "name": "update_recipe", "path": "/home/kavia/workspace/code-generation/recipe-explorer-184547-184606/recipe_app_backend/app/storage.py", "pattern": "/^def update_recipe(recipe_id: int, updates: Dict) -> Optional[Dict]:$/", "language": "Python", "typeref": "typename:Optional[Dict]", "kind": "function", "signature": "(recipe_id: int, updates: Dict)"}], "hash": "cb47ff13b176f122ed83cda563e8c63d", "format-version": 4, "code-base-name": "recipe_app_backend", "filename": "recipe_app_backend/app/storage.py", "fields": [{"name": "_STORAGE_FILE = os.environ.get(\"RECIPES_STORE_PATH\", \"data\\/recipes.json\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_lock = threading.RLock()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_session_lock = threading.RLock()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Dict[str, Dict] _sessions", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"15": ""}]}